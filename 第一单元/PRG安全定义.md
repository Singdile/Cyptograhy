### what it means that is "indistinguishable" from random （不可区分性）

一个多项式时间的攻击者无法有效区分某个对象(密文、输出流) 与 真正的随机对象。

比如：
![](../Attachment_box/Pasted%20image%2020250704171337.png)

从密钥空间随机选取一个密钥，通过 PRG 生成伪随机密钥流。

![](../Attachment_box/Pasted%20image%2020250704171355.png)

从均匀分布的空间中，随机抽取真正随机的密钥流

a pseudo-random distribution generated by this generator G. Because the seed space is so small, the set of possible outputs is really, really small, it's tiny inside of, 01 to the N. And this is really all that the generator can output. And yet, hat we're arguing is that an adversary who looks at the output of the generator in this tiny set can't distinguish it from the output of the uniform distribution over the entire set.

由于密钥空间非常小，通过PRG生成的N位密钥流的范围也是比较小的。这里探讨的是，攻击者无法分别PRG生成的密钥流和从均匀分布的N位空间中直接抽取的N位密钥流。如下图所示。

![](../Attachment_box/Pasted%20image%2020250704172513.png)


---
### Statistical Testy (统计测试)

统计测试 A 是一个高效（多项式时间）算法，输入一个长度为 n的比特串  $x∈\{0,1\}^n$  , 输出结果为“0”或“1”，用于判定该串是否“看起来”像随机。



#### 举例——最高位偏差测试
假设有一个  $PRG \space G ⁣:K→\{0,1\}^n$  ，并且它的最高位（most significant bit, MSB）在大约 2/3 的密钥下都会是 1，而在真正随机的 n-比特串中，MSB 为 1 的概率只有 1/2。

构造统计算法A：
```
输入：x ∈ {0,1}ⁿ
输出：如果 x 的最高位是 1，输出1，；否则输出 0
```

对于输入PRG的A的输出：
$$ Pr[A(G(k))=1]=2/3$$

对于输入均匀随机的 n-bit 串的输出：

$$ Pr[A(r)=1]=1/2 $$



---
### Advantage (区分优势)
对于给定  $PRG \quad G:k↦\{0,1\}^n$  和统计测试 A，其区分优势定义为：

$$ Adv_{PRG}​[A,G]= \space ∣Pr[A(G(k))=1]−Pr[A(r)=1]∣$$

其中其中 k 是从密钥空间随机选出的，r 是均匀随机的 n-比特串。

显然，Adv 越接近 0 ，越表示测试 A 不能区分 PRG 和 均匀随机分布 生成的比特串。



---



### Secure PRG（ 安全的PRG）

![](../Attachment_box/Pasted%20image%2020250704203721.png)

如果对于所有高效统计测试 A，它的Advantage都是 **可忽略的** ，那么对应的PRG 是安全的。



---

以下是 **Yao 定理（Next‑bit Unpredictability Theorem）** 的正式陈述和简要证明思路，说明“下一比特不可预测”与“整体与随机分布不可区分”是等价的：

---
下面用更结构化和严谨的方式给出 **Yao 定理** 的正式表述，辅助理解它为何成立以及为什么如此重要：

---

###  Yao 定理（Next‑bit Unpredictability Theorem）

假设 G 是一个多项式时间可计算的生成器，将 n-比特种子映射到 m(n)-比特的输出（通常 m(n)>n）。以下两条性质等价：

---

#### 1. 下一比特不可预测性（Next‑bit Unpredictability）

对于任意多项式时间的预测算法 B 和任意位置 $1≤i≤m(n)$，若给定前 $i−1$ 位输出序列，则预测第  $i$  位的正确概率仅为 $\frac12 + \text{negl}(n)$。  
换言之，无法以显著优于随机猜测的概率预测下一个比特。

---

#### 2. 伪随机不可区分性（Indistinguishability）

对于任何多项式时间算法（统计测试） A，在区分 G 的输出与等长均匀随机串时，其优势（区别判断输出 1 的概率差）均为 **可忽略的**：  
  
也就是说，输出与真随机串计算上无法区分。

---
## 🧠 本质与意义

- Yao 定理展示了两种安全性的等价：**单步不可预测性** ↔ **整体不可区分性**。
    
- 从安全证明的角度而言，通常只需验证“下一比特不可预测”，懂得这一定理即可确保 PRG 的整体伪随机安全性。

- 对于构造 PRG 及证明安全，这种等价性提供了简洁且可构造的路径，使形式化分析变得易于处理。
    

